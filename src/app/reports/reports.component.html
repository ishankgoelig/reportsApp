<div class="container py-3">
  <h1><b>All Reports</b></h1>

  <!-- Header Actions: Search | Sort | Add -->
  <div class="row align-items-center mb-4">
    <div class="col-md-4 mb-2 mb-md-0">
      <input
        type="text"
        class="form-control"
        placeholder="Search..."
        id="searchInput"
        (keyup)="applyFilter($event)"
      />
    </div>
    <div class="col-md-8 mb-2 mb-md-0">
      <div class="d-flex justify-content-end align-items-center gap-3">
        <button class="btn btn-zendu-blue">
          <i class="bi bi-plus-circle me-1"></i> Add new Report
        </button>
        <span class="sort-label">Sort by:</span>
        <select
          class="custom-select border-0 bg-transparent fw-semibold"
          id="sortData"
          [(ngModel)]="sortBy"
          (change)="applySort()"
        >
          <option value="Newest">Newest</option>
          <option value="Oldest">Oldest</option>
        </select>
        <i class="bi bi-caret-down-fill dropdown-arrow"></i>
      </div>
    </div>
  </div>

  <div
    *ngFor="let report of pagedData"
    class="report-row p-3 mb-2 border rounded cursor-pointer"
    [ngClass]="{ 'selected-row': report.id === hoveredReportId }"
    (mouseenter)="hoveredReportId = report.id"
    (mouseleave)="hoveredReportId = null"
    tabindex="0"
    role="button"
    [attr.aria-pressed]="report.id === hoveredReportId"
  >
    <div class="row align-items-center gy-2 gx-0 flex-md-nowrap flex-wrap">
      <!-- Left: Icon and Report Title -->
      <div
        class="col-12 col-md-auto d-flex align-items-center gap-2 flex-shrink-0 report-name-col mb-2 mb-md-0"
      >
        <i class="bi bi-pie-chart-fill text-primary fs-5"></i>
        <span class="fw-semibold text-truncate report-name-text">{{
          report.reportName
        }}</span>
      </div>

      <!-- Center: Info (stacked) -->
      <div
        class="col-12 col-md d-flex flex-wrap flex-md-nowrap flex-grow-1 justify-content-center align-items-stretch gap-3 gap-md-4 report-info-cols mb-2 mb-md-0"
      >
        <div class="d-flex flex-column align-items-start report-info-col">
          <span class="text-muted small">Created:</span>
          <span class="fw-semibold text-truncate report-info-text">{{
            report.createdDate | date : "mediumDate"
          }}</span>
        </div>
        <div class="d-flex flex-column align-items-start report-info-col">
          <span class="text-muted small">Modified:</span>
          <span class="fw-semibold text-truncate report-info-text">{{
            report.modifiedDate | date : "mediumDate"
          }}</span>
        </div>
        <div class="d-flex flex-column align-items-start report-info-col">
          <span class="text-muted small">Owner:</span>
          <span class="fw-semibold text-truncate report-info-text">{{
            report.owner
          }}</span>
        </div>
        <div class="d-flex flex-column align-items-start report-info-col">
          <span class="text-muted small">Form:</span>
          <span
            class="text-decoration-none fw-semibold text-primary text-truncate report-info-text"
            >{{ report.formName }}</span
          >
        </div>
      </div>

      <!-- Right: Actions (only show if selected) -->
      <div
        class="col-12 col-md-auto d-flex gap-2 align-items-center mt-2 mt-md-0 report-actions justify-content-md-end justify-content-start"
      >
        <ng-container *ngIf="report.id === hoveredReportId">
          <button
            class="btn btn-link text-danger p-0"
            (click)="openDeleteDialog(report)"
            (keyup.enter)="openDeleteDialog(report)"
            tabindex="0"
            role="button"
            aria-label="Delete report"
          >
            <i class="bi bi-trash-fill fs-5"></i>
          </button>
          <button
            class="btn btn-link text-primary p-0"
            (click)="$event.stopPropagation()"
            (keyup.enter)="$event.stopPropagation()"
            tabindex="0"
            role="button"
            aria-label="Edit report"
          >
            <i class="bi bi-pencil-fill fs-5"></i>
          </button>
        </ng-container>
      </div>
    </div>
  </div>

  <!-- Pagination -->
  <nav class="d-flex justify-content-between align-items-center mt-5">
    <span>
      {{ pageRangeText }}
    </span>
    <ul class="pagination pagination-sm mb-0 pagination-zendu-blue">
      <li class="page-item" [class.disabled]="currentPage === 1">
        <a
          class="page-link"
          (click)="goToPage(currentPage - 1)"
          (keyup.enter)="goToPage(currentPage - 1)"
          tabindex="0"
          role="button"
          aria-label="Previous page"
          >&laquo;</a
        >
      </li>
      <li
        class="page-item"
        *ngFor="let page of pages"
        [class.active]="page === currentPage"
      >
        <a
          class="page-link"
          (click)="goToPage(page)"
          (keyup.enter)="goToPage(page)"
          tabindex="0"
          role="button"
          [attr.aria-label]="'Go to page ' + page"
          >{{ page }}</a
        >
      </li>
      <li class="page-item" [class.disabled]="currentPage === totalPages">
        <a
          class="page-link"
          (click)="goToPage(currentPage + 1)"
          (keyup.enter)="goToPage(currentPage + 1)"
          tabindex="0"
          role="button"
          aria-label="Next page"
          >&raquo;</a
        >
      </li>
    </ul>
  </nav>
</div>
